---
import { GoogleSpreadsheet } from "google-spreadsheet";
import {JWT} from "google-auth-library";

export async function loadDocument(){
const apiKey = import.meta.env.SHEETS_PRIVATE_KEY;
const key =  import.meta.env.SHEETS_KEY_ID;
const email = import.meta.env.SERVICE_ACCOUNT_EMAIL;
// Initialize auth - see https://theoephraim.github.io/node-google-spreadsheet/#/guides/authentication
const serviceAccountAuth = new JWT({
    // env var values here are copied from service account credentials generated by google
    // see "Authentication" section in docs for more info
    email: email,
    key: apiKey,
    scopes: ['https://www.googleapis.com/auth/spreadsheets'],
});

const doc = new GoogleSpreadsheet(key, serviceAccountAuth);

await doc.loadInfo();
return doc;
}
---

